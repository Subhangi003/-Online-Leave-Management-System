<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leave Management System</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <h2>Welcome to Leave Management System</h2>
  <a href="leave_form.html">Submit Leave Request</a> |
  <a href="admin.php">Admin Panel</a>
</body>
</html>

<!-- leave_form.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Submit Leave Request</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <h2>Leave Request Form</h2>
  <form action="submit_leave.php" method="POST">
    <label>Name:</label><br>
    <input type="text" name="name" required><br>

    <label>Email:</label><br>
    <input type="email" name="email" required><br>

    <label>Reason for Leave:</label><br>
    <textarea name="reason" required></textarea><br>

    <label>Start Date:</label><br>
    <input type="date" name="start_date" required><br>

    <label>End Date:</label><br>
    <input type="date" name="end_date" required><br>

    <button type="submit">Submit</button>
  </form>
</body>
</html>

<!-- submit_leave.php -->
<?php
include 'db/connection.php';

$name = $_POST['name'];
$email = $_POST['email'];
$reason = $_POST['reason'];
$start_date = $_POST['start_date'];
$end_date = $_POST['end_date'];

$sql = "INSERT INTO leave_requests (name, email, reason, start_date, end_date) 
        VALUES ('$name', '$email', '$reason', '$start_date', '$end_date')";

if (mysqli_query($conn, $sql)) {
    echo "<h3>Leave request submitted successfully.</h3>";
} else {
    echo "Error: " . mysqli_error($conn);
}
?>
<a href="index.html">Back to Home</a>

<!-- admin.php -->
<?php
include 'db/connection.php';
$result = mysqli_query($conn, "SELECT * FROM leave_requests ORDER BY submitted_at DESC");
?>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <h2>Admin Dashboard - Leave Requests</h2>
  <table border="1">
    <tr>
      <th>ID</th><th>Name</th><th>Email</th><th>Reason</th><th>Start Date</th><th>End Date</th><th>Status</th><th>Action</th>
    </tr>
    <?php while ($row = mysqli_fetch_assoc($result)) { ?>
    <tr>
      <td><?= $row['id'] ?></td>
      <td><?= $row['name'] ?></td>
      <td><?= $row['email'] ?></td>
      <td><?= $row['reason'] ?></td>
      <td><?= $row['start_date'] ?></td>
      <td><?= $row['end_date'] ?></td>
      <td><?= $row['status'] ?></td>
      <td>
        <a href="update_status.php?id=<?= $row['id'] ?>&status=Approved">Approve</a> |
        <a href="update_status.php?id=<?= $row['id'] ?>&status=Rejected">Reject</a>
      </td>
    </tr>
    <?php } ?>
  </table>
</body>
</html>

<!-- update_status.php -->
<?php
include 'db/connection.php';
$id = $_GET['id'];
$status = $_GET['status'];

mysqli_query($conn, "UPDATE leave_requests SET status='$status' WHERE id=$id");
header("Location: admin.php");
?>

<!-- db/connection.php -->
<?php
$host = "localhost";
$user = "root";
$password = "";
$database = "leave_system";

$conn = mysqli_connect($host, $user, $password, $database);

if (!$conn) {
    die("Connection failed: " . mysqli_connect_error());
}
?>

/* css/style.css */
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: #f5f5f5;
}

h2 {
  color: #333;
}

form {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  max-width: 500px;
}

input, textarea {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
  border-radius: 4px;
  border: 1px solid #ccc;
}

button {
  background: #007bff;
  color: white;
  border: none;
  padding: 10px 15px;
  cursor: pointer;
  border-radius: 4px;
}

button:hover {
  background: #0056b3;
}

table {
  width: 100%;
  background: #fff;
  border-collapse: collapse;
  margin-top: 20px;
}

table, th, td {
  border: 1px solid #ddd;
  padding: 10px;
}

th {
  background: #007bff;
  color: white;
}
